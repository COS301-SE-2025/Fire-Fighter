import{$ as j,A as y,B as O,D as v,E as U,F as _,G as P,H as k,I as T,J as A,K as W,L as G,M as L,N as V,O as D,P as M,Q as H,R as F,S as B,T as $,U as E,X as x,Y,Z as K,_ as b,aa as N,ba as q,ca as J,da as z,ea as Q,fa as X,ga as Z,ha as ee,ia as s,la as te,ma as m,na as l,q as S,r as C,s as w,t as f,u as p,v as o,w as d,x as h,y as R,z as I}from"./chunk-X5HHX3WJ.js";import{g as n}from"./chunk-OLRFWS6T.js";var se=(()=>{class a extends te{constructor(){super(),this.lastConfirmationResult=new Map;let e=s();e.onAuthStateChanged(t=>this.handleAuthStateChange(t)),e.onIdTokenChanged(t=>void this.handleIdTokenChange(t))}applyActionCode(e){return n(this,null,function*(){let t=s();return k(t,e.oobCode)})}createUserWithEmailAndPassword(e){return n(this,null,function*(){let t=s(),r=yield T(t,e.email,e.password);return this.createSignInResult(r,null)})}confirmPasswordReset(e){return n(this,null,function*(){let t=s();return P(t,e.oobCode,e.newPassword)})}confirmVerificationCode(e){return n(this,null,function*(){let{verificationCode:t,verificationId:r}=e,i=this.lastConfirmationResult.get(r);if(!i)throw new Error(a.ERROR_CONFIRMATION_RESULT_MISSING);let c=yield i.confirm(t);return this.createSignInResult(c,null)})}deleteUser(){return n(this,null,function*(){let t=s().currentUser;if(!t)throw new Error(a.ERROR_NO_USER_SIGNED_IN);return Y(t)})}fetchSignInMethodsForEmail(e){return n(this,null,function*(){let t=s();return{signInMethods:yield V(t,e.email)}})}getPendingAuthResult(){return n(this,null,function*(){this.throwNotAvailableError()})}getCurrentUser(){return n(this,null,function*(){let e=s();return{user:this.createUserResult(e.currentUser)}})}getIdToken(e){return n(this,null,function*(){let t=s();if(!t.currentUser)throw new Error(a.ERROR_NO_USER_SIGNED_IN);return{token:(yield t.currentUser.getIdToken(e==null?void 0:e.forceRefresh))||""}})}getRedirectResult(){return n(this,null,function*(){let e=s(),t=yield ee(e),r=t?o.credentialFromResult(t):null;return this.createSignInResult(t,r)})}getTenantId(){return n(this,null,function*(){return{tenantId:s().tenantId}})}isSignInWithEmailLink(e){return n(this,null,function*(){let t=s();return{isSignInWithEmailLink:G(t,e.emailLink)}})}linkWithApple(e){return n(this,null,function*(){let t=new o(l.APPLE);this.applySignInOptions(e||{},t);let r=yield this.linkCurrentUserWithPopupOrRedirect(t,e==null?void 0:e.mode),i=o.credentialFromResult(r);return this.createSignInResult(r,i)})}linkWithEmailAndPassword(e){return n(this,null,function*(){let t=p.credential(e.email,e.password),r=yield this.linkCurrentUserWithCredential(t);return this.createSignInResult(r,t)})}linkWithEmailLink(e){return n(this,null,function*(){let t=p.credentialWithLink(e.email,e.emailLink),r=yield this.linkCurrentUserWithCredential(t);return this.createSignInResult(r,t)})}linkWithFacebook(e){return n(this,null,function*(){let t=new d;this.applySignInOptions(e||{},t);let r=yield this.linkCurrentUserWithPopupOrRedirect(t,e==null?void 0:e.mode),i=d.credentialFromResult(r);return this.createSignInResult(r,i)})}linkWithGameCenter(){return n(this,null,function*(){this.throwNotAvailableError()})}linkWithGithub(e){return n(this,null,function*(){let t=new R;this.applySignInOptions(e||{},t);let r=yield this.linkCurrentUserWithPopupOrRedirect(t,e==null?void 0:e.mode),i=R.credentialFromResult(r);return this.createSignInResult(r,i)})}linkWithGoogle(e){return n(this,null,function*(){let t=new h;this.applySignInOptions(e||{},t);let r=yield this.linkCurrentUserWithPopupOrRedirect(t,e==null?void 0:e.mode),i=h.credentialFromResult(r);return this.createSignInResult(r,i)})}linkWithMicrosoft(e){return n(this,null,function*(){let t=new o(l.MICROSOFT);this.applySignInOptions(e||{},t);let r=yield this.linkCurrentUserWithPopupOrRedirect(t,e==null?void 0:e.mode),i=o.credentialFromResult(r);return this.createSignInResult(r,i)})}linkWithOpenIdConnect(e){return n(this,null,function*(){let t=new o(e.providerId);this.applySignInOptions(e,t);let r=yield this.linkCurrentUserWithPopupOrRedirect(t,e.mode),i=o.credentialFromResult(r);return this.createSignInResult(r,i)})}linkWithPhoneNumber(e){return n(this,null,function*(){let r=s().currentUser;if(!r)throw new Error(a.ERROR_NO_USER_SIGNED_IN);if(!e.phoneNumber)throw new Error(a.ERROR_PHONE_NUMBER_MISSING);if(!e.recaptchaVerifier||!(e.recaptchaVerifier instanceof N))throw new Error(a.ERROR_RECAPTCHA_VERIFIER_MISSING);try{let i=yield J(r,e.phoneNumber,e.recaptchaVerifier),{verificationId:c}=i;this.lastConfirmationResult.set(c,i);let u={verificationId:c};this.notifyListeners(a.PHONE_CODE_SENT_EVENT,u)}catch(i){let c={message:this.getErrorMessage(i)};this.notifyListeners(a.PHONE_VERIFICATION_FAILED_EVENT,c)}})}linkWithPlayGames(){return n(this,null,function*(){this.throwNotAvailableError()})}linkWithTwitter(e){return n(this,null,function*(){let t=new I;this.applySignInOptions(e||{},t);let r=yield this.linkCurrentUserWithPopupOrRedirect(t,e==null?void 0:e.mode),i=I.credentialFromResult(r);return this.createSignInResult(r,i)})}linkWithYahoo(e){return n(this,null,function*(){let t=new o(l.YAHOO);this.applySignInOptions(e||{},t);let r=yield this.linkCurrentUserWithPopupOrRedirect(t,e==null?void 0:e.mode),i=o.credentialFromResult(r);return this.createSignInResult(r,i)})}reload(){return n(this,null,function*(){let t=s().currentUser;if(!t)throw new Error(a.ERROR_NO_USER_SIGNED_IN);return S(t)})}revokeAccessToken(e){return n(this,null,function*(){let t=s();return x(t,e.token)})}sendEmailVerification(e){return n(this,null,function*(){let r=s().currentUser;if(!r)throw new Error(a.ERROR_NO_USER_SIGNED_IN);return D(r,e==null?void 0:e.actionCodeSettings)})}sendPasswordResetEmail(e){return n(this,null,function*(){let t=s();return _(t,e.email,e.actionCodeSettings)})}sendSignInLinkToEmail(e){return n(this,null,function*(){let t=s();return W(t,e.email,e.actionCodeSettings)})}setLanguageCode(e){return n(this,null,function*(){let t=s();t.languageCode=e.languageCode})}setPersistence(e){return n(this,null,function*(){let t=s();switch(e.persistence){case m.BrowserLocal:yield E(t,K);break;case m.BrowserSession:yield E(t,b);break;case m.IndexedDbLocal:yield E(t,j);break;case m.InMemory:yield E(t,C);break}})}setTenantId(e){return n(this,null,function*(){let t=s();t.tenantId=e.tenantId})}signInAnonymously(){return n(this,null,function*(){let e=s(),t=yield y(e);return this.createSignInResult(t,null)})}signInWithApple(e){return n(this,null,function*(){let t=new o(l.APPLE);this.applySignInOptions(e||{},t);let r=yield this.signInWithPopupOrRedirect(t,e==null?void 0:e.mode),i=o.credentialFromResult(r);return this.createSignInResult(r,i)})}signInWithCustomToken(e){return n(this,null,function*(){let t=s(),r=yield U(t,e.token);return this.createSignInResult(r,null)})}signInWithEmailAndPassword(e){return n(this,null,function*(){let t=s(),r=yield A(t,e.email,e.password);return this.createSignInResult(r,null)})}signInWithEmailLink(e){return n(this,null,function*(){let t=s(),r=yield L(t,e.email,e.emailLink);return this.createSignInResult(r,null)})}signInWithFacebook(e){return n(this,null,function*(){let t=new d;this.applySignInOptions(e||{},t);let r=yield this.signInWithPopupOrRedirect(t,e==null?void 0:e.mode),i=d.credentialFromResult(r);return this.createSignInResult(r,i)})}signInWithGithub(e){return n(this,null,function*(){let t=new R;this.applySignInOptions(e||{},t);let r=yield this.signInWithPopupOrRedirect(t,e==null?void 0:e.mode),i=R.credentialFromResult(r);return this.createSignInResult(r,i)})}signInWithGoogle(e){return n(this,null,function*(){let t=new h;this.applySignInOptions(e||{},t);let r=yield this.signInWithPopupOrRedirect(t,e==null?void 0:e.mode),i=h.credentialFromResult(r);return this.createSignInResult(r,i)})}signInWithMicrosoft(e){return n(this,null,function*(){let t=new o(l.MICROSOFT);this.applySignInOptions(e||{},t);let r=yield this.signInWithPopupOrRedirect(t,e==null?void 0:e.mode),i=o.credentialFromResult(r);return this.createSignInResult(r,i)})}signInWithOpenIdConnect(e){return n(this,null,function*(){let t=new o(e.providerId);this.applySignInOptions(e,t);let r=yield this.signInWithPopupOrRedirect(t,e.mode),i=o.credentialFromResult(r);return this.createSignInResult(r,i)})}signInWithPhoneNumber(e){return n(this,null,function*(){if(!e.phoneNumber)throw new Error(a.ERROR_PHONE_NUMBER_MISSING);if(!e.recaptchaVerifier||!(e.recaptchaVerifier instanceof N))throw new Error(a.ERROR_RECAPTCHA_VERIFIER_MISSING);let t=s();try{let r=yield q(t,e.phoneNumber,e.recaptchaVerifier),{verificationId:i}=r;this.lastConfirmationResult.set(i,r);let c={verificationId:i};this.notifyListeners(a.PHONE_CODE_SENT_EVENT,c)}catch(r){let i={message:this.getErrorMessage(r)};this.notifyListeners(a.PHONE_VERIFICATION_FAILED_EVENT,i)}})}signInWithPlayGames(){return n(this,null,function*(){this.throwNotAvailableError()})}signInWithGameCenter(){return n(this,null,function*(){this.throwNotAvailableError()})}signInWithTwitter(e){return n(this,null,function*(){let t=new I;this.applySignInOptions(e||{},t);let r=yield this.signInWithPopupOrRedirect(t,e==null?void 0:e.mode),i=I.credentialFromResult(r);return this.createSignInResult(r,i)})}signInWithYahoo(e){return n(this,null,function*(){let t=new o(l.YAHOO);this.applySignInOptions(e||{},t);let r=yield this.signInWithPopupOrRedirect(t,e==null?void 0:e.mode),i=o.credentialFromResult(r);return this.createSignInResult(r,i)})}signOut(){return n(this,null,function*(){yield s().signOut()})}unlink(e){return n(this,null,function*(){let t=s();if(!t.currentUser)throw new Error(a.ERROR_NO_USER_SIGNED_IN);let r=yield O(t.currentUser,e.providerId);return{user:this.createUserResult(r)}})}updateEmail(e){return n(this,null,function*(){let r=s().currentUser;if(!r)throw new Error(a.ERROR_NO_USER_SIGNED_IN);return F(r,e.newEmail)})}updatePassword(e){return n(this,null,function*(){let r=s().currentUser;if(!r)throw new Error(a.ERROR_NO_USER_SIGNED_IN);return B(r,e.newPassword)})}updateProfile(e){return n(this,null,function*(){let r=s().currentUser;if(!r)throw new Error(a.ERROR_NO_USER_SIGNED_IN);return H(r,{displayName:e.displayName,photoURL:e.photoUrl})})}useAppLanguage(){return n(this,null,function*(){s().useDeviceLanguage()})}useEmulator(e){return n(this,null,function*(){let t=s(),r=e.port||9099,i=e.scheme||"http";e.host.includes("://")?w(t,`${e.host}:${r}`):w(t,`${i}://${e.host}:${r}`)})}verifyBeforeUpdateEmail(e){return n(this,null,function*(){let r=s().currentUser;if(!r)throw new Error(a.ERROR_NO_USER_SIGNED_IN);return M(r,e==null?void 0:e.newEmail,e==null?void 0:e.actionCodeSettings)})}handleAuthStateChange(e){let r={user:this.createUserResult(e)};this.notifyListeners(a.AUTH_STATE_CHANGE_EVENT,r,!0)}handleIdTokenChange(e){return n(this,null,function*(){if(!e)return;let r={token:yield e.getIdToken(!1)};this.notifyListeners(a.ID_TOKEN_CHANGE_EVENT,r,!0)})}applySignInOptions(e,t){if(e.customParameters){let r={};e.customParameters.map(i=>{r[i.key]=i.value}),t.setCustomParameters(r)}if(e.scopes)for(let r of e.scopes)t.addScope(r)}signInWithPopupOrRedirect(e,t){let r=s();return t==="redirect"?X(r,e):z(r,e)}linkCurrentUserWithPopupOrRedirect(e,t){let r=s();if(!r.currentUser)throw new Error(a.ERROR_NO_USER_SIGNED_IN);return t==="redirect"?Z(r.currentUser,e):Q(r.currentUser,e)}linkCurrentUserWithCredential(e){let t=s();if(!t.currentUser)throw new Error(a.ERROR_NO_USER_SIGNED_IN);return v(t.currentUser,e)}requestAppTrackingTransparencyPermission(){this.throwNotAvailableError()}checkAppTrackingTransparencyPermission(){this.throwNotAvailableError()}createSignInResult(e,t){let r=this.createUserResult((e==null?void 0:e.user)||null),i=this.createCredentialResult(t),c=this.createAdditionalUserInfoResult(e);return{user:r,credential:i,additionalUserInfo:c}}createCredentialResult(e){if(!e)return null;let t={providerId:e.providerId};return e instanceof f&&(t.accessToken=e.accessToken,t.idToken=e.idToken,t.secret=e.secret),t}createUserResult(e){return e?{displayName:e.displayName,email:e.email,emailVerified:e.emailVerified,isAnonymous:e.isAnonymous,metadata:this.createUserMetadataResult(e.metadata),phoneNumber:e.phoneNumber,photoUrl:e.photoURL,providerData:this.createUserProviderDataResult(e.providerData),providerId:e.providerId,tenantId:e.tenantId,uid:e.uid}:null}createUserMetadataResult(e){let t={};return e.creationTime&&(t.creationTime=Date.parse(e.creationTime)),e.lastSignInTime&&(t.lastSignInTime=Date.parse(e.lastSignInTime)),t}createUserProviderDataResult(e){return e.map(t=>({displayName:t.displayName,email:t.email,phoneNumber:t.phoneNumber,photoUrl:t.photoURL,providerId:t.providerId,uid:t.uid}))}createAdditionalUserInfoResult(e){if(!e)return null;let t=$(e);if(!t)return null;let{isNewUser:r,profile:i,providerId:c,username:u}=t,g={isNewUser:r};return c!==null&&(g.providerId=c),i!==null&&(g.profile=i),u!=null&&(g.username=u),g}getErrorMessage(e){return e instanceof Object&&"message"in e&&typeof e.message=="string"?e.message:JSON.stringify(e)}throwNotAvailableError(){throw new Error("Not available on web.")}}return a.AUTH_STATE_CHANGE_EVENT="authStateChange",a.ID_TOKEN_CHANGE_EVENT="idTokenChange",a.PHONE_CODE_SENT_EVENT="phoneCodeSent",a.PHONE_VERIFICATION_FAILED_EVENT="phoneVerificationFailed",a.ERROR_NO_USER_SIGNED_IN="No user is signed in.",a.ERROR_PHONE_NUMBER_MISSING="phoneNumber must be provided.",a.ERROR_RECAPTCHA_VERIFIER_MISSING="recaptchaVerifier must be provided and must be an instance of RecaptchaVerifier.",a.ERROR_CONFIRMATION_RESULT_MISSING="No confirmation result with this verification id was found.",a})();export{se as FirebaseAuthenticationWeb};
