<app-navbar></app-navbar>

<ion-content [fullscreen]="true" class="ion-padding dark:bg-gray-900">
  <div class="space-y-4 mt-4 px-4">
    <ion-toolbar class="bg-white shadow-md dark:bg-gray-800">
      <ion-title class="text-xl font-bold px-4 py-2 dark:text-white">Notifications</ion-title>
      <p class="px-4 text-sm text-gray-500 dark:text-gray-400">Stay updated on FireFighter activity</p>
      <div class="px-4 py-2 text-right">
        <button 
          (click)="markAllAsRead()"
          class="px-4 py-1 text-sm font-medium text-white bg-blue-700 rounded hover:bg-blue-800">
          âœ” Mark All as Read
        </button>
      </div>
    </ion-toolbar>

    <!-- No Notifications Message -->
    <div *ngIf="(notifications$ | async)?.length === 0" class="text-center py-8 text-gray-500 dark:text-gray-400">
      <p class="text-lg">No notifications</p>
      <p class="text-sm mt-2">You're all caught up!</p>
    </div>

    <!-- Notifications List -->
    <ng-container *ngIf="notifications$ | async as notifications">
      <div *ngFor="let notification of notifications" 
           [ngClass]="{
             'bg-blue-50 border-l-4 border-blue-400 dark:bg-blue-900/50 dark:border-blue-600': !notification.read,
             'border border-gray-200 dark:border-gray-700': notification.read
           }"
           class="p-4 rounded shadow-sm">
        <div class="flex justify-between items-start">
          <div>
            <h3 [ngClass]="{
              'text-red-600 dark:text-white': notification.type === 'request_completed',
              'text-blue-600 dark:text-blue-400': notification.type === 'new_request' || notification.type === 'ticket_created',
              'text-green-600 dark:text-green-400': notification.type === 'request_approved',
              'text-gray-800 dark:text-white': notification.type === 'action_taken'
            }" class="font-bold">
              {{ notification.title }}
            </h3>
            <p class="text-gray-800 dark:text-white">
              {{ notification.message }}
            </p>
            <a *ngIf="notification.ticketId" 
               [routerLink]="['/requests']" 
               class="text-blue-700 underline text-sm dark:text-blue-300">
              View Details
            </a>
          </div>
          <div class="text-sm text-gray-500 dark:text-gray-400">
            {{ getTimeAgo(notification.timestamp) }}
          </div>
        </div>
        <div *ngIf="!notification.read" class="mt-2 text-right">
          <button 
            (click)="markAsRead(notification.id)"
            class="text-sm text-blue-700 underline dark:text-blue-300">
            Mark as Read
          </button>
        </div>
      </div>
    </ng-container>
  </div>
</ion-content>
